<!DOCTYPE html><html lang="en" ng-app="angularIOApp" itemscope itemtype="http://schema.org/Framework"><head><title>Testing - ts</title><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Angular is a development platform for building mobile and desktop web applications"/><meta name="keywords" content="Angular, AngularJS, AngularDart, Javscript, Dart, Framework, JavaScript MVC, Google"/><meta name="robots" content="all"/><meta name="referrer" content="origin"/><meta name="viewport" id="viewport" content="width=device-width, initial-scale=1"/><meta property="og:title" content="Angular 2"/><meta property="og:image" content="/resources/images/logos/standard/shield-large.png"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="184"/><meta property="og:image:height" content="200"/><meta property="og:description" content="Angular is a development platform for building mobile and desktop web applications"/><meta itemprop="name" content="Angular 2"/><meta itemprop="description" content="Angular is a development platform for building mobile and desktop web applications"/><meta itemprop="image" content="https://angular.io/resources/images/logos/standard/shield-large.png"/><link rel="icon" type="image/x-icon" href="/resources/images/icons/favicon.ico"/><link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.css"/><link href="https://fonts.googleapis.com/css?family=Roboto:400,300,500,400italic,700" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/><link rel="stylesheet" href="/resources/css/vendor/icomoon/style.css"/><link rel="stylesheet" href="/resources/css/vendor/animate.css"/><link rel="stylesheet" href="/resources/css/main.css"/><!-- MOBILE ICONS -->
<link rel="apple-touch-icon" sizes="57x57" href="/resources/images/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/resources/images/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/resources/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/resources/images/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/resources/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/resources/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/resources/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/resources/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/resources/images/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/resources/images/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/resources/images/favicons/manifest.json"></head><body ng-controller="AppCtrl as appCtrl" class="l-offset-nav l-offset-side-nav"><md-toolbar scroll-y-offset-element="scroll-y-offset-element" class="main-nav background-regal l-pinned-top l-layer-5"><nav><h1><a href="/" md-button>Angular <sup>by Google</sup></a></h1><button aria-label="View Menu" ng-click="appCtrl.toggleMainMenu($event)" md-button="md-button" class="main-nav-button main-nav-mobile-trigger l-right">Site Menu <span class="icon icon-arrow-drop-down"></span></button><ul ng-class="appCtrl.showMainNav ? 'is-visible' : ''"><li class="l-left"><a class="main-nav-button" href="/features.html" md-button>Features</a></li><li class="l-left"><a class="main-nav-button" href="/docs/ts/latest/" md-button>Docs</a></li><li class="l-left"><a class="main-nav-button" href="/events.html" md-button>Events</a></li><li class="l-left"><a class="main-nav-button" href="/news.html" md-button>News</a></li><li class="l-right"><a class="main-nav-button" href="/docs/ts/latest/quickstart.html" md-button>Get Started</a></li></ul></nav></md-toolbar><!-- Include this file ONLY when current.path[2] is defined--><nav class="side-nav l-pinned-left l-layer-4 l-offset-nav"><!-- SEARCH BAR--><header class="side-nav-search st-input-wrapper"><form class="st-input-inner"><label for="search-io" class="is-hidden">Search Docs</label><input type="search" id="search-io" placeholder="SEARCH DOCS..."/></form><button aria-label="View Docs Menu" ng-click="appCtrl.toggleDocsMenu($event)" md-button="md-button" class="mobile-trigger button">Docs <span class="icon icon-arrow-drop-down"></span></button></header><div ng-class="appCtrl.showDocsNav ? 'is-visible' : ''" class="side-nav-secondary"><div class="nav-blocks"><a href="/docs/ts/latest/quickstart.html" title="Get up and running with Angular 2" class="nav-title ">Quickstart</a></div><div class="nav-blocks"><a href="/docs/ts/latest/tutorial/" title="The Tour of Heroes tutorial takes us through the steps of creating an Angular application in TypeScript." class="nav-title ">Tutorial<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-ordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/" title="The Tour of Heroes tutorial takes us through the steps of creating an Angular application in TypeScript.">1. Introduction</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt1.html" title="We build a simple hero editor">2. The Hero Editor</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt2.html" title="We build a master/detail page with a list of heroes">3. Master/Detail</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt3.html" title="We refactor the master/detail view into separate components">4. Multiple Components</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt4.html" title="We create a reusable service to manage our hero data calls">5. Services</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt5.html" title="We add the Angular Component Router and learn to navigate among the views">6. Routing</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt6.html" title="We convert our service and components to use Http">7. Http</a></li></ul></div></div><div class="nav-blocks"><a href="/docs/ts/latest/guide/" title="How to read and use this documentation" class="nav-title ">Basics<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-ordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/guide/" title="How to read and use this documentation">1. Overview</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/architecture.html" title="The basic building blocks of Angular 2 applications">2. Architecture</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/displaying-data.html" title="Interpolation and other forms of property binding help us show app data in the UI.">3. Displaying Data</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/user-input.html" title="User input triggers DOM events. We listen to those events with event bindings that funnel updated values back into our components and models.">4. User Input</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/forms.html" title="A form creates a cohesive, effective, and compelling data entry experience. An Angular form coordinates a set of data-bound user controls, tracks changes, validates input, and presents errors.">5. Forms</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/dependency-injection.html" title="Angular's dependency injection system creates and delivers dependent services &quot;just-in-time&quot;.">6. Dependency Injection</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/template-syntax.html" title="Learn how to write templates that display data and consume user events with the help of data binding.">7. Template Syntax</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/cheatsheet.html" title="A quick guide to Angular syntax.">8. Angular Cheat Sheet</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/style-guide.html" title="Write Angular 2 with style.">9. Style Guide</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/glossary.html" title="Brief definitions of the most important words in the Angular 2 vocabulary">10. Glossary</a></li></ul></div></div><div class="nav-blocks"><a href="/docs/ts/latest/guide/attribute-directives.html" title="Attribute directives attach behavior to elements." class="nav-title is-nav-title-selected">Developer Guide<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-unordered-lists"><ul><li class="nav-list-item "><a href="/docs/ts/latest/guide/attribute-directives.html" title="Attribute directives attach behavior to elements.">Attribute Directives</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/component-styles.html" title="Learn how to apply CSS styles to components.">Component Styles</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/hierarchical-dependency-injection.html" title="Angular's hierarchical dependency injection system supports nested injectors in parallel with the component tree.">Hierarchical Injectors</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/server-communication.html" title="Talk to a remote server with an HTTP Client.">HTTP Client</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/lifecycle-hooks.html" title="Angular calls lifecycle hook methods on directives and components as it creates, changes, and destroys them.">Lifecycle Hooks</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/npm-packages.html" title="Details of the recommended npm packages and the different kinds of package dependencies">Npm Packages</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/pipes.html" title="Pipes transform displayed values within a template.">Pipes</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/router-deprecated.html" title="The deprecated Beta Router.">Router (Deprecated Beta)</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/structural-directives.html" title="Angular has a powerful template engine that lets us easily manipulate the DOM structure of our elements.">Structural Directives</a></li><li class="nav-list-item is-selected"><a href="/docs/ts/latest/guide/testing.html" title="Techniques and practices for testing an Angular 2 app">Testing</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/typescript-configuration.html" title="TypeScript configuration for Angular 2 developers">TypeScript Configuration</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/upgrade.html" title="Angular 1 applications can be incrementally upgraded to Angular 2.">Upgrading from 1.x</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/webpack.html" title="Create your Angular 2 applications with a Webpack based tooling">Webpack: an introduction</a></li></ul></div></div><div class="nav-blocks"><a href="/docs/ts/latest/cookbook/" title="A collection of recipes for common Angular application scenarios" class="nav-title ">Cookbook<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-unordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/" title="A collection of recipes for common Angular application scenarios">Overview</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/a1-a2-quick-reference.html" title="Learn how Angular 1 concepts and techniques map to Angular 2">Angular 1 to 2 Quick Ref</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/component-communication.html" title="Share information between different directives and components">Component Interaction</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/component-relative-paths.html" title="Use relative URLs for component templates and styles.">Component-relative Paths</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/dependency-injection.html" title="Techniques for Dependency Injection">Dependency Injection</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/dynamic-form.html" title="Render dynamic forms with NgFormModel">Dynamic Form</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/set-document-title.html" title="Setting the document or window title using the Title service.">Set the Document Title</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/ts-to-js.html" title="Convert Angular 2 TypeScript examples into ES5 JavaScript">TypeScript to JavaScript</a></li></ul></div></div><div class="nav-blocks"><a href="/docs/ts/latest/api/" title="API Preview" class="nav-title ">API Reference</a></div></div></nav><script>// Could put in appCtrl but only needed here and clear here
(function scrollToSelectedLink() {
  var sideNav = document.getElementsByClassName('side-nav')[0];
  var link = sideNav.getElementsByClassName('is-selected')[0];
  if(link && link.offsetTop > window.innerHeight){
    sideNav.scrollTop = link.offsetTop - (window.innerHeight/2);
    //alert("offsetTop: " + link.offsetTop + " side-nav top is " + sideNav.scrollTop);
  }
})()</script><!-- Refer to jade.template.html and addJadeDataDocsProcessor to figure out where the context of this jade file originates--><!-- renamer :: String -> String--><!-- Renames `Let` and `Var` into `Const`--><header class="hero background-sky"><div class="inner-header"><h1 class="hero-title text-display-1 ">Testing</h1><span class="badges"></span></div><!-- Replace _ underscores with . dots --><!-- VERSION TREE CREATOR MIXIN --><!-- BUTTON TITLE GENERATION  --><!-- DROPDOWN BUTTON --><nav class="dropdown"><button aria-label="Select a version of Angular" md-button="md-button" ng-click="appCtrl.toggleVersionMenu($event)" class="dropdown-button">Angular 2 for TypeScript  <span class="icon icon-arrow-drop-down"></span></button><div ng-click="appCtrl.toggleVersionMenu($event)" ng-show="appCtrl.showMenu" class="overlay ng-hide"></div><!-- DROPDOWN MENU --><div ng-class="appCtrl.showMenu ? 'is-visible' : ''" class="dropdown-menu"><ul><li><a href="/docs/ts/latest/guide/testing.html" md-button>Angular 2 for TypeScript </a></li></ul><ul><li><a href="/docs/js/latest/guide/testing.html" md-button>Angular 2 for JavaScript </a></li></ul><ul><li><a href="/docs/dart/latest/guide/testing.html" md-button>Angular 2 for Dart </a></li></ul></div></nav></header><div class="banner"><p class="text-body">Techniques and practices for testing an Angular 2 app</p></div><article class="l-content-small grid-fluid docs-content"><div class="c10"><div class="showcase"><div class="showcase-content"><p>We write <strong>unit tests</strong> to explore and confirm the <strong>behavior</strong> of parts of our application.</p>
<ol>
<li>They <strong>guard</strong> against breaking existing code (“regressions”) when we make changes.</li>
<li>They <strong>clarify</strong> what  the code does both when used as intended and when faced with deviant conditions.</li>
<li>They <strong>reveal</strong> mistakes in design and implementation. Tests force us to look at our code from many angles. When a part of our application seems hard to test, we may have discovered a design flaw, something we can cure now rather than later when it becomes expensive to fix.</li>
</ol>
<a id="top"></a><h1 id="table-of-contents">Table of Contents</h1>
<ol>
<li><p><a href="#jasmine-101">Jasmine Testing 101</a></p>
<ul>
<li>setup to run Jasmine tests in the browser</li>
<li>basic Jasmine testing skills</li>
<li>write simple Jasmine tests in TypeScript</li>
<li>debug a test in the browser</li>
</ul>
</li>
<li><p><a href="#aut">The Application Under Test</a></p>
</li>
<li><p><a href="#first-app-tests">First app test</a></p>
<ul>
<li>test a simple application interface outside of Angular</li>
<li>where to put the test file</li>
<li>load a test file with systemJS</li>
</ul>
</li>
<li><p><a href="#pipe-testing">Pipe driven development</a></p>
<ul>
<li>create a test before creating a class</li>
<li>load multiple test files in our test harness, using system.js</li>
<li>add the Angular 2 library to our test harness</li>
<li>watch the new test fail, and fix it</li>
</ul>
</li>
<li><p>Test an Asynchronous Service (forthcoming)</p>
<ul>
<li>test an asynchronous service class outside of Angular</li>
<li>write a test plan in code</li>
<li>fake a dependency</li>
<li>master the <code>catch(fail).then(done)</code> pattern</li>
<li>move setup to <code>beforeEach</code></li>
<li>test when a dependency fails</li>
<li>control async test timeout</li>
</ul>
</li>
<li><p>The Angular Test Environment (forthcoming)</p>
<ul>
<li>the Angular test environment and why we need help</li>
<li>add the Angular Test libraries to the  test harness</li>
<li>test the same async service using Angular Dependency Injection</li>
<li>reduce friction with test helpers</li>
<li>introducing spies</li>
</ul>
</li>
<li><p>Test a Component (forthcoming)</p>
<ul>
<li>test the component outside of Angular</li>
<li>mock the dependent asynchronous service</li>
<li>simulate interaction with the view (no DOM)</li>
<li>use a spy-promise to control asynchronous test flow</li>
</ul>
</li>
<li><p>Test a Component in the DOM (forthcoming</p>
<ul>
<li>test the component inside the Angular test environment</li>
<li>use the <code>TestComponentBuilder</code></li>
<li>more test helpers</li>
<li>interact with the DOM</li>
<li>bind to a mock dependent asynchronous service</li>
</ul>
</li>
<li><p>Run the tests with karma (forthcoming)</p>
</li>
</ol>
<p>It’s a big agenda. Fortunately, you can learn a little bit at a time and put each lesson to use.</p>
<a href="#top" class="to-top">Back to top</a><div class="l-hr"></div><a id="jasmine-101"></a><h1 id="jasmine-testing-101">Jasmine Testing 101</h1>
<script>function why(id, backTo) {
  var id = "#"+id;
  var el = document.querySelector(id);
  el.hidden=el.hidden=!el.hidden;

  if (el.hidden && backTo){
    // the next line is required to work around a bug in WebKit (Chrome / Safari)
    location.href = "#";
    location.href =  "#" + backTo;
  }
}</script><script>function verbose(isVerbose) {
  isVerbose = !! isVerbose;
  var el = document.querySelector('button.verbose.off');
  el.style.display = isVerbose ? 'block' : 'none';
  var el = document.querySelector('button.verbose.on');
  el.style.display = isVerbose ? 'none' : 'block';

  CCSStylesheetRuleStyle('main','.l-verbose-section', 'display',
    isVerbose ? 'block' : 'none');
}
</script><script>function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  /* returns the value of the element style of the rule in the stylesheet
  *  If no value is given, reads the value
  *  If value is given, the value is changed and returned
  *  If '' (empty string) is given, erases the value.
  *  The browser will apply the default one
  *
  * string stylesheet: part of the .css name to be recognized, e.g. 'default'
  * string selectorText: css selector, e.g. '#myId', '.myClass', 'thead td'
  * string style: camelCase element style, e.g. 'fontSize'
  * string value optional : the new value
  */
  var CCSstyle = undefined, rules, sheet;
  for(var m in document.styleSheets){
    sheet = document.styleSheets[m];
    if(sheet.href && sheet.href.indexOf(stylesheet) != -1){
    rules = sheet[document.all ? 'rules' : 'cssRules'];
    for(var n in rules){
      console.log(rules[n].selectorText);
      if(rules[n].selectorText == selectorText){
        CCSstyle = rules[n].style;
        break;
      }
    }
    break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
}</script><p>We’ll write our tests with the <a href="http://jasmine.github.io/2.3/introduction.html">Jasmine test framework</a>.
We’ll start by getting <em>some</em> tests to work - <em>any</em> tests at all.</p>
<p>We will learn</p>
<ul>
<li>basic Jasmine testing skills</li>
<li>to run our tests in the browser</li>
<li>to write simple Jasmine tests in TypeScript</li>
<li>to debug a test in the browser</li>
</ul>
<p><strong>Create a new project folder</strong> perhaps called <code>angular2-unit-testing</code>.</p>
<div class="l-main-section"></div><h2 id="install-npm-packages-locally">Install npm packages locally</h2>
<p>Next follow all of  the steps prescribed in  “Install npm packages locally” of the
<a href="../quickstart.html">QuickStart</a>.</p>
<p>We’ll also add the Jasmine package via <code>npm</code>:</p>
<pre class="prettyprint lang-bash"><code>npm install jasmine-core --save-dev --save-exact</code></pre><div class="alert is-important"><p>Be sure to install <code>jasmine-core</code> , not <code>jasmine</code>!</p>
</div><p><strong>Create a sub-folder <code>src</code> </strong> for our tests and then <strong>cd into it</strong>.</p>
<p>We are going to <strong>display and control our tests in the browser</strong>.</p>
<div class="l-sub-section"><p>The browser is nice during development of a few tests. It’s not the best venue for working with a lot of tests and it won’t do at all for build automation. We’ll switch to the karma test-runner when the time comes. But the browser will do for now.</p>
</div><p>Create a new file called<code>unit-tests.html</code> and enter the following:</p>
<div class="example-title">unit-tests.html</div><code-example language="html" format="linenums">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
  &lt;title&gt;Ng App Unit Tests&lt;/title&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;../node_modules/jasmine-core/lib/jasmine-core/jasmine.css&quot;&gt;

  &lt;script src=&quot;../node_modules/jasmine-core/lib/jasmine-core/jasmine.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;../node_modules/jasmine-core/lib/jasmine-core/jasmine-html.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;../node_modules/jasmine-core/lib/jasmine-core/boot.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;/body&gt;

&lt;/html&gt;
</code-example><p>In the head we have three Jasmine scripts and one Jasmine css file. That’s the foundation for running any tests.</p>
<p>We’ll write our first test with inline JavaScript inside the body tag:</p>
<code-example language="html" format="">&lt;body&gt;
  &lt;!-- Unit Testing Chapter #1: Proof of life.  --&gt;
  &lt;script&gt;
    it(&#39;true is true&#39;, function(){ expect(true).toEqual(true); });
  &lt;/script&gt;
&lt;/body&gt;
</code-example><p>Now open <code>unit-tests.html</code> in a browser and see the Jasmine HTML test output:</p>
<figure class="image-display"><img src="/resources/images/devguide/jasmine-testing-101/jasmine-1-spec-0-failures.png" style="height:170px" alt="Jasmine HTML test output"></figure><p>It doesn’t get much simpler than that!</p>
<div class="l-main-section"></div><h2 id="first-typescript-test">First TypeScript Test</h2>
<p>Perhaps too simple. We won’t write our entire test suite inside one HTML file.
Let’s <strong>extract</strong> that line of test code to a <strong>new file in <code>src</code> called <code>1st.spec.ts</code> </strong> .</p>
<div class="l-sub-section"><p>Among Jasmine developers, a test is known as a “spec” and test filenames include the word “spec”.  We’ll stick with that convention.</p>
</div><p>The test we wrote is valid TypeScript because any JavaScript is valid TypeScript. But let’s make it more modern with an arrow function:</p>
<div class="example-title">1st.spec.ts</div><code-example language="ts" format="">it(&#39;true is true&#39;, () =&gt; expect(true).toEqual(true));
</code-example><p>Now modify <code>unit-tests.html</code> to load the script:</p>
<code-example language="html" format="">&lt;script src=&quot;1st.spec.js&quot;&gt;&lt;/script&gt;
</code-example><p>Hold on! We wrote a TypeScript file but we’re loading a JavaScript file?</p>
<p>That’s a reminder that we need to compile our TypeScript test files as we do our TypeScript application files.  Do that next.</p>
<div class="l-main-section"></div><h2 id="prepare-for-typescript">Prepare for TypeScript</h2>
<p>As we’ve seen before, we first have to tell the compiler how to compile our TypeScript files with
a <strong> <code>tsconfig.json</code> </strong>.</p>
<p>We can copy one from the quickstart we wrote previously and paste it into our src sub-folder.
It should look something like this:</p>
<div class="example-title">tsconfig.json</div><code-example language="json" format="linenums">{
  &quot;compilerOptions&quot;: {
    &quot;target&quot;: &quot;es5&quot;,
    &quot;module&quot;: &quot;system&quot;,
    &quot;moduleResolution&quot;: &quot;node&quot;,
    &quot;sourceMap&quot;: true,
    &quot;emitDecoratorMetadata&quot;: true,
    &quot;experimentalDecorators&quot;: true,
    &quot;removeComments&quot;: false,
    &quot;noImplicitAny&quot;: true,
    &quot;suppressImplicitAnyIndexErrors&quot;: true
  }
}
</code-example><h2 id="compile-and-run">Compile and Run</h2>
<p>Compile in the terminal window using the npm script command</p>
<pre class="prettyprint lang-bash"><code>npm run tsc</code></pre><div class="alert is-helpful"><p>Our editor and the compiler may complain that they don’t know
what <code>it</code> and <code>expect</code> are because they lack the typing files that describe Jasmine.
We can ignore those annoying complaints for now as they are harmless.</p>
</div><p>If we reload the browser, we should see the same Jasmine test-runner output as before.</p>
<p>We’ll be evolving these tests rapidly and it would be nice to have the browser refresh automatically as we make changes and recompile.</p>
<p>Let’s launch with <strong>live-server</strong> in a second terminal window:</p>
<pre class="prettyprint lang-bash"><code>npm start</code></pre><p>Now reload <code>unit-tests.html</code> in the browser</p>
<p>We should get the same Jasmine test-runner output as before.</p>
<div class="l-main-section"></div><h2 id="add-a-describe-and-another-test">Add a describe and another test</h2>
<p>We can’t tell what file produced these test results. We only have one file at the moment but soon we’ll write more.</p>
<p>We should wrap this test into something that identifies the file. In Jasmine that “something” is a <code>describe</code> function.  Every test file should have at least one <code>describe</code> that identifies the file holding the test(s).</p>
<p>Here’s what our revised <code>1st.spec.ts</code> looks like when wrapped in a <code>describe</code>:</p>
<code-example language="ts" format="linenums"> describe(&#39;1st tests&#39;, () =&gt; {

  it(&#39;true is true&#39;, () =&gt; expect(true).toEqual(true));

});
</code-example><p>And here’s how the test report displays it.</p>
<figure class="image-display"><img src="/resources/images/devguide/jasmine-testing-101/test-report-1-spec-0-failures.png" style="height:100px" alt="1 spec, 0 failures"></figure><p>Let’s add another Jasmine test to <code>1st.spec.ts</code></p>
<code-example language="ts" format="">it(&#39;null is not the same thing as undefined&#39;,
  () =&gt; expect(null).not.toEqual(undefined)
);
</code-example><p>You knew that right?  Let’s prove it with this test. The browser should refresh after you paste that test, and show:</p>
<figure class="image-display"><img src="/resources/images/devguide/jasmine-testing-101/test-report-2-specs-0-failures.png" style="height:100px" alt="refreshed 2 specs, 0 failures"></figure><p>What does a failing test look like? Remove the <code>.not</code>. The browser refreshes and shows:</p>
<figure class="image-display"><img src="/resources/images/devguide/jasmine-testing-101/test-report-2-specs-1-failure.png" style="height:190px" alt="failing test 2 specs, 1 failure"></figure><p>Click the <code>Spec List</code> link just below “2 specs, 1 failure” to see the summary again:</p>
<figure class="image-display"><img src="/resources/images/devguide/jasmine-testing-101/spec-list-2-specs-1-failure.png" style="height:140px" alt="2 specs, 1 failure"></figure><p>We can re-run just the failing test by double-clicking it.  Try it!</p>
<div class="l-main-section"></div><h2 id="debug-the-test">Debug the test</h2>
<p>Suppose we didn’t know what was going on.  We can debug it in the browser.</p>
<ul>
<li>Open the browser’s “Developer Tools” (F12 or Ctrl-Shift-I).</li>
<li>Pick the “sources” section</li>
<li>Open the <code>1st.spec.ts</code> test file (Ctrl-P, then start typing the name of the file).</li>
<li>Set a breakpoint on the second line of the failing test</li>
<li>Refresh the browser … and it stops at our breakpoint.</li>
<li>Open the console window at the bottom  (press Esc)</li>
<li>Type <code>null === undefined</code> … … and we should see this:</li>
</ul>
<figure class="image-display"><img src="/resources/images/devguide/jasmine-testing-101/null-to-equal-undefined.png" style="height:500px" alt="null === undefined"></figure><p>How about that!  They really aren’t equal.</p>
<ul>
<li>remove the breakpoint (right-click in the “Breakpoints” section and chose “Remove breakpoint”)</li>
<li>Click the “play” icon to resume the test  (or F8)</li>
</ul>
<p>And the test finishes.  Close the browser tools (click the close box or press F12 or Ctrl-Shift-I)</p>
<p>Fix the test (restore the <code>.not</code>);  the browser should refresh automatically and all tests pass.</p>
<p>Congratulations … you’ve completed Jasmine testing 101.</p>
<p>Now that we’re familiar with Jasmine on its own, we’re ready to test an application.</p>
<!-- TODO
.l-main-section
:marked
  ## Learn more
  Learn more about basic Jasmine testing here
  [Resources TBD](./#)
  --><a href="#top" class="to-top">Back to top</a><div class="l-hr"></div><a id="aut"></a><h1 id="the-application-to-test">The Application to Test</h1>
<script>function why(id, backTo) {
  var id = "#"+id;
  var el = document.querySelector(id);
  el.hidden=el.hidden=!el.hidden;

  if (el.hidden && backTo){
    // the next line is required to work around a bug in WebKit (Chrome / Safari)
    location.href = "#";
    location.href =  "#" + backTo;
  }
}</script><script>function verbose(isVerbose) {
  isVerbose = !! isVerbose;
  var el = document.querySelector('button.verbose.off');
  el.style.display = isVerbose ? 'block' : 'none';
  var el = document.querySelector('button.verbose.on');
  el.style.display = isVerbose ? 'none' : 'block';

  CCSStylesheetRuleStyle('main','.l-verbose-section', 'display',
    isVerbose ? 'block' : 'none');
}
</script><script>function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  /* returns the value of the element style of the rule in the stylesheet
  *  If no value is given, reads the value
  *  If value is given, the value is changed and returned
  *  If '' (empty string) is given, erases the value.
  *  The browser will apply the default one
  *
  * string stylesheet: part of the .css name to be recognized, e.g. 'default'
  * string selectorText: css selector, e.g. '#myId', '.myClass', 'thead td'
  * string style: camelCase element style, e.g. 'fontSize'
  * string value optional : the new value
  */
  var CCSstyle = undefined, rules, sheet;
  for(var m in document.styleSheets){
    sheet = document.styleSheets[m];
    if(sheet.href && sheet.href.indexOf(stylesheet) != -1){
    rules = sheet[document.all ? 'rules' : 'cssRules'];
    for(var n in rules){
      console.log(rules[n].selectorText);
      if(rules[n].selectorText == selectorText){
        CCSstyle = rules[n].style;
        break;
      }
    }
    break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
}</script><p>We’ll need an Angular application to test, one as simple as possible while having most of the angular features we want to test.</p>
<p>What better app than our own <a href="../tutorial/toh-pt5.html">The Tour of Heroes</a>? We&#39;re already quite familiar with it and it fits our criteria, so let&#39;s try to test what we&#39;ve done there.</p>
<p>We might end up modifying it a bit, because it doesn&#39;t have everything we want to test, but it&#39;s the perfect starting point.</p>
<p>Create a copy of the Tour of Heroes app so that we can fiddle without fear.</p>
<a href="#top" class="to-top">Back to top</a><div class="l-hr"></div><a id="first-app-tests"></a><h1 id="first-app-test">First app test</h1>
<script>function why(id, backTo) {
  var id = "#"+id;
  var el = document.querySelector(id);
  el.hidden=el.hidden=!el.hidden;

  if (el.hidden && backTo){
    // the next line is required to work around a bug in WebKit (Chrome / Safari)
    location.href = "#";
    location.href =  "#" + backTo;
  }
}</script><script>function verbose(isVerbose) {
  isVerbose = !! isVerbose;
  var el = document.querySelector('button.verbose.off');
  el.style.display = isVerbose ? 'block' : 'none';
  var el = document.querySelector('button.verbose.on');
  el.style.display = isVerbose ? 'none' : 'block';

  CCSStylesheetRuleStyle('main','.l-verbose-section', 'display',
    isVerbose ? 'block' : 'none');
}
</script><script>function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  /* returns the value of the element style of the rule in the stylesheet
  *  If no value is given, reads the value
  *  If value is given, the value is changed and returned
  *  If '' (empty string) is given, erases the value.
  *  The browser will apply the default one
  *
  * string stylesheet: part of the .css name to be recognized, e.g. 'default'
  * string selectorText: css selector, e.g. '#myId', '.myClass', 'thead td'
  * string style: camelCase element style, e.g. 'fontSize'
  * string value optional : the new value
  */
  var CCSstyle = undefined, rules, sheet;
  for(var m in document.styleSheets){
    sheet = document.styleSheets[m];
    if(sheet.href && sheet.href.indexOf(stylesheet) != -1){
    rules = sheet[document.all ? 'rules' : 'cssRules'];
    for(var n in rules){
      console.log(rules[n].selectorText);
      if(rules[n].selectorText == selectorText){
        CCSstyle = rules[n].style;
        break;
      }
    }
    break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
}</script><p>In this chapter we&#39;ll setup the environment for testing our sample application and write a few easy Jasmine tests of the app&#39;s simplest parts.
We&#39;ll learn:</p>
<ul>
<li>to test one of our application files</li>
<li>why we prefer our test files to be next to their corresponding source files</li>
<li>to run tests with an <code>npm</code> command</li>
<li>load the test file with SystemJS</li>
</ul>
<div class="callout is-helpful"><header>Prior Knowledge</header><p>The Unit Testing chapters build upon each other. We recommend reading them in order.
We&#39;re also assuming that you&#39;re already comfortable with basic Angular 2 concepts and the tools
we introduced in the <a href="../quickstart.html">QuickStart</a> and
the <a href="../tutorial/">Tour of Heroes</a> tutorial
such as <code>npm</code>, <code>gulp</code>, and <code>live-server</code>.</p>
</div><div class="l-main-section"></div><h2 id="create-the-test-runner-html">Create the test-runner HTML</h2>
<p>Locate the folder that contains the application <code>index.html</code> for your testing copy of Tour of Heroes.</p>
<p>Create a new, sibling HTML file, <strong> <code>unit-tests.html</code> </strong> and copy over the same basic material from the  <code>unit-tests.html</code> in the <a href="./jasmine-testing-101.html">Jasmine 101</a> chapter.</p>
<div class="example-title">unit-tests.html</div><code-example language="html" format="linenums">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
  &lt;title&gt;Ng App Unit Tests&lt;/title&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;../node_modules/jasmine-core/lib/jasmine-core/jasmine.css&quot;&gt;

  &lt;script src=&quot;../node_modules/jasmine-core/lib/jasmine-core/jasmine.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;../node_modules/jasmine-core/lib/jasmine-core/jasmine-html.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;../node_modules/jasmine-core/lib/jasmine-core/boot.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;/body&gt;

&lt;/html&gt;
</code-example><p>We&#39;re picking up right where we left off. All we&#39;ve done is change the title.</p>
<div class="l-main-section"></div><h2 id="update-package-json-for-testing">Update <code>package.json</code> for testing</h2>
<p>We must install the Jasmine package as well:</p>
<pre class="prettyprint lang-bash"><code>npm install jasmine-core --save-dev --save-exact</code></pre><div class="alert is-important">Be sure to install <code>jasmine-core</code> , not <code>jasmine</code>!</div><p>Let&#39;s make one more change to the <code>package.json</code> script commands.</p>
<p><strong>Open the <code>package.json</code> </strong> and scroll to the <code>scripts</code> node and add in a new one:</p>
<code-example format="">"test": "live-server --open=unit-tests.html"
</code-example><p>That command will launch <code>live-server</code> and open a browser to the <code>unit-tests.html</code> page we just wrote.</p>
<div class="l-main-section"></div><h2 id="first-app-tests">First app tests</h2>
<p>We can start testing <em>some</em> of our app right away. For example, we can test the <code>Hero</code> interface:</p>
<code-example language="ts" format="linenums">export class Hero {
  id: number;
  name: string;
}
</code-example><p>Let&#39;s add a couple of simple tests in a new file.</p>
<code-example language="ts" format="linenums">import { Hero } from &#39;./hero&#39;;

describe(&#39;Hero&#39;, () =&gt; {

  it(&#39;has name&#39;, () =&gt; {
    let hero: Hero = {id: 1, name: &#39;Super Cat&#39;};
    expect(hero.name).toEqual(&#39;Super Cat&#39;);
  });

  it(&#39;has id&#39;, () =&gt; {
    let hero: Hero = {id: 1, name: &#39;Super Cat&#39;};
    expect(hero.id).toEqual(1);
  });
});
</code-example><p>That&#39;s the basic Jasmine we learned back in &quot;Jasmine 101&quot;.</p>
<p>Notice that we surrounded our tests with <strong> <code>describe(&#39;Hero&#39;)</code> </strong>.</p>
<p><strong>By convention, our test always begin with a <code>describe</code> that identifies the application part under test.</strong></p>
<p>The description should be sufficient to identify the tested application part and its source file. Almost any convention will do as long as you and your team follow it consistently and are never confused.</p>
<p>But we haven&#39;t saved this test yet.</p>
<div class="l-main-section"></div><h2 id="where-do-tests-go-">Where do tests go?</h2>
<p>Some people like to keep their tests in a <code>tests</code> folder parallel to the application source folder.</p>
<p>We are not those people. We like our unit tests to be close to the source code that they test. We prefer this approach because</p>
<ul>
<li>The tests are easy to find</li>
<li>We see at a glance if an application part lacks tests.</li>
<li>Nearby tests can teach us about how the part works; they express the developers intention and reveal how the developer thinks the part should behave under a variety of circumstances.</li>
<li>When we move the source (inevitable), we remember to move the test.</li>
<li>When we rename the source file (inevitable), we remember to rename the test file.</li>
</ul>
<p>We can&#39;t think of a downside. The server doesn&#39;t care where they are.  They are easy to find and distinguish from application files when named conventionally.</p>
<div class="l-sub-section"><p>You may put your tests elsewhere if you wish. 
We&#39;re putting ours inside the app, next to the source files that they test.</p>
</div><div class="l-main-section"></div><h2 id="first-spec-file">First spec file</h2>
<p><strong>Create</strong> a new file, <strong> <code>hero.spec.ts</code> </strong> in <code>app</code> next to <code>hero.ts</code>.</p>
<p>Notice the &quot;.spec&quot; suffix in the test file&#39;s filename, appended to the name of the file holding the application part we&#39;re testing.</p>
<div class="alert is-important"> All of our unit test files follow this .spec naming pattern.</div><p>Save the tests we just made in <code>hero.spec.ts</code>:</p>
<code-example language="ts" format="linenums">import { Hero } from &#39;./hero&#39;;

describe(&#39;Hero&#39;, () =&gt; {

  it(&#39;has name&#39;, () =&gt; {
    let hero: Hero = {id: 1, name: &#39;Super Cat&#39;};
    expect(hero.name).toEqual(&#39;Super Cat&#39;);
  });

  it(&#39;has id&#39;, () =&gt; {
    let hero: Hero = {id: 1, name: &#39;Super Cat&#39;};
    expect(hero.id).toEqual(1);
  });
});
</code-example><h3 id="import-the-part-we-re-testing">Import the part we&#39;re testing</h3>
<p>We have an <code>import {Hero} from &#39;./hero&#39;</code> statement.</p>
<p>If we forgot this import, a TypeScript-aware editor would warn us, with a squiggly red underline, that it can&#39;t find the definition of the <code>Hero</code> interface.</p>
<h3 id="update-unit-tests-html">Update unit-tests.html</h3>
<p>Next we update the <code>unit-tests.html</code> with a reference to our new <code>hero.spec.ts</code> file. Delete the inline test code.  The revised pertinent HTML looks like this:</p>
<code-example language="html" format="">&lt;script src=&quot;app/hero.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;app/hero.spec.js&quot;&gt;&lt;/script&gt;
</code-example><h3 id="run-and-fail">Run and Fail</h3>
<p>Look over at the browser (live-server will have reloaded it).  The browser displays</p>
<figure class="image-display"><img src="/resources/images/devguide/first-app-tests/Jasmine-not-running-tests.png" style="width:400px" alt="Jasmine not running any tests"></figure><p>That&#39;s Jasmine saying &quot;<strong>things are <em>so</em> bad that <em>I&#39;m not running any tests</em>.</strong>&quot;</p>
<p>Open the browser&#39;s Developer Tools (F12, Ctrl-Shift-i). There&#39;s an error:</p>
<code-example format="" language="html">Uncaught ReferenceError: System is not defined
</code-example><div class="l-main-section"></div><h2 id="load-tests-with-systemjs">Load tests with SystemJS</h2>
<p>The immediate cause of the error is the <code>export</code> statement in <code>hero.ts</code>.
That error was there all along.
It wasn&#39;t a problem until we tried to <code>import</code> the <code>Hero</code> interface in our tests.</p>
<p>Our test environment lacks support for module loading.
Apparently we can&#39;t simply load our application and test scripts like we do with 3rd party JavaScript libraries.</p>
<p>We are committed to module loading in our application.
Our app will call <code>import</code>.  Our tests must do so too.</p>
<p>We add module loading support in four steps:</p>
<ol>
<li>add the <em>SystemJS</em> module management library</li>
<li>configure <em>SystemJS</em> to look for JavaScript files by default</li>
<li>import our test files</li>
<li>tell Jasmine to run the imported tests</li>
</ol>
<p>These steps are all clearly visible, in exactly that order, in the following lines that
replace the <code>&lt;body&gt;</code> contents in <code>unit-tests.html</code>:</p>
<code-example language="html" format="">&lt;body&gt;
  &lt;!-- #1. add the system.js library --&gt;
  &lt;script src=&quot;../node_modules/systemjs/dist/system.src.js&quot;&gt;&lt;/script&gt;

  &lt;script&gt;
    // #2. Configure systemjs to use the .js extension
    //     for imports from the app folder
    System.config({
      packages: {
        &#39;app&#39;: {defaultExtension: &#39;js&#39;}
      }
    });

    // #3. Import the spec file explicitly
    System.import(&#39;app/hero.spec&#39;)

      // #4. wait for all imports to load ...
      //     then re-execute `window.onload` which
      //     triggers the Jasmine test-runner start
      //     or explain what went wrong.
      .then(window.onload)
      .catch(console.error.bind(console));
  &lt;/script&gt;
&lt;/body&gt;
</code-example><p>Look in the browser window. Our tests pass once again.</p>
<figure class="image-display"><img src="/resources/images/devguide/first-app-tests/test-passed-once-again.png" style="width:400px" alt="Tests passed once again"></figure><div class="l-main-section"></div><h2 id="observations">Observations</h2>
<h3 id="system-config">System.config</h3>
<p>System.js demands that we specify a default extension for the filenames that correspond to whatever it is asked to import.
Without that default, it would translate an import statement such as <code>import {Hero} from &#39;./hero&#39;</code> to a request for the file named <code>hero</code>.
Not <code>hero.js</code>. Just plain <code>hero</code>.  Our server error with &quot;404 - not found&quot; because it doesn&#39;t have a file of that name.</p>
<p>Once configured with a default extension of &#39;js&#39;,&nbsp;  SystemJS requests <code>hero.js</code> which <em>does</em> exist and is promptly returned by our server.</p>
<h3 id="asynchronous-system-import">Asynchronous System.import</h3>
<p>The call to <code>System.import</code> shouldn&#39;t surprise us but it&#39;s asynchronous nature might.
If we ponder this for a moment, we realize that it must be asynchronous because
System.js may have to fetch the corresponding JavaScript file from the server.
Accordingly, <code>System.import</code> returns a promise and we must wait for that promise to resolve.
Only then can Jasmine start evaluating the imported tests.</p>
<h3 id="window-onload">window.onload</h3>
<p>Jasmine doesn&#39;t have a <code>start</code> method.  It wires its own start to the browser window&#39;s <code>load</code> event.
That makes sense if we&#39;re loading our tests with script tags.
The browser raises the <code>load</code> event when it finishes loading all scripts.</p>
<p>But we&#39;re not loading test scripts inline anymore.
We&#39;re using the SystemJS module loader and it won&#39;t be done until long after the browser raised the <code>load</code> event.
Meanwhile, Jasmine started and ran to completion … with no tests to evaluate … before the import completed.</p>
<p>So we must wait until the import completes and only then call the window <code>onLoad</code> handler.
Jasmine re-starts, this time with our imported test queued up.</p>
<div class="l-main-section"></div><h2 id="what-s-next-">What&#39;s Next?</h2>
<p>We are able to test a part of our application with simple Jasmine tests.
The part was a stand-alone interface that made no mention or use of Angular.</p>
<p>That&#39;s not rare but it&#39;s not typical either. 
Most of our application parts make some use of the Angular framework.
Let&#39;s test a <em>pipe</em> class that does rely on Angular.</p>
<a href="#top" class="to-top">Back to top</a><div class="l-hr"></div><a id="pipe-testing"></a><h1 id="pipe-driven-development">Pipe driven development</h1>
<script>function why(id, backTo) {
  var id = "#"+id;
  var el = document.querySelector(id);
  el.hidden=el.hidden=!el.hidden;

  if (el.hidden && backTo){
    // the next line is required to work around a bug in WebKit (Chrome / Safari)
    location.href = "#";
    location.href =  "#" + backTo;
  }
}</script><script>function verbose(isVerbose) {
  isVerbose = !! isVerbose;
  var el = document.querySelector('button.verbose.off');
  el.style.display = isVerbose ? 'block' : 'none';
  var el = document.querySelector('button.verbose.on');
  el.style.display = isVerbose ? 'none' : 'block';

  CCSStylesheetRuleStyle('main','.l-verbose-section', 'display',
    isVerbose ? 'block' : 'none');
}
</script><script>function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  /* returns the value of the element style of the rule in the stylesheet
  *  If no value is given, reads the value
  *  If value is given, the value is changed and returned
  *  If '' (empty string) is given, erases the value.
  *  The browser will apply the default one
  *
  * string stylesheet: part of the .css name to be recognized, e.g. 'default'
  * string selectorText: css selector, e.g. '#myId', '.myClass', 'thead td'
  * string style: camelCase element style, e.g. 'fontSize'
  * string value optional : the new value
  */
  var CCSstyle = undefined, rules, sheet;
  for(var m in document.styleSheets){
    sheet = document.styleSheets[m];
    if(sheet.href && sheet.href.indexOf(stylesheet) != -1){
    rules = sheet[document.all ? 'rules' : 'cssRules'];
    for(var n in rules){
      console.log(rules[n].selectorText);
      if(rules[n].selectorText == selectorText){
        CCSstyle = rules[n].style;
        break;
      }
    }
    break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
}</script><p>We’ll test an Angular pipe in this chapter.</p>
<p>An Angular pipe is a declarative way in HTML to transform some input into some displayable output.</p>
<p>We don&#39;t have a pipe though, since in Tour of Heroes we didn&#39;t create any pipes. It uses a pipe though, the <code>uppercase</code> pipe that comes with Angular 2.</p>
<p>We can make our own <code>my-uppercase</code> pipe that does exactly the same as the <code>uppercase</code> pipe and test that.</p>
<p>Since we&#39;re getting ready to write some code we want to test, let&#39;s take this opportunity to talk just a little bit about <a href="https://en.wikipedia.org/wiki/Test-driven_development">Test Driven Development</a>. There&#39;s a lot written about this topic so we don&#39;t want to have an exhaustive description here, but rather a practical application.</p>
<p>We already know <em>exactly</em> what we want the <code>uppercase</code> pipe to do. We could say our ...expectations... of it are very well defined.</p>
<p>We always use expectations our expectations to guide development, but sometimes it&#39;s hard to see the forest for the trees when we&#39;re right in the middle of coding. This is especially evident in larger tasks.</p>
<p>So one thing we can do is put those expectations down as cold hard test code. We were going to test things manually anyway, so doing it <em>before</em> we have even one line of code isn&#39;t going to hurt. </p>
<p>Worst thing that can happen is have that test fail, but on the way to fixing it we&#39;ll end up creating our pipe. So in a sense, the failing test will <em>tell you what it wants</em> to pass.</p>
<p>We&#39;re just putting down expectations, nothing more. If we were to put them down on paper, they would look like this:</p>
<pre><code>  MyUppercasePipe
    transforms &quot;abc&quot; to &quot;ABC&quot;
    transforms &quot;abc def&quot; to &quot;ABC DEF&quot;
    leaves &quot;ABC DEF&quot; unchanged
</code></pre><p>All we need to know to put down our expectations as code is how a pipe class looks like from the outside. From the <a href="pipes#custom-pipes">pipe developer guide</a> we know that a pipe implements a <code>transform</code> method. </p>
<p>Putting it down as Jasmine expectations, they would look something like this:</p>
<code-example language="ts" format="linenums">it(&#39;transforms &quot;abc&quot; to &quot;ABC&quot;&#39;, () =&gt; {
  expect(pipe.transform(&#39;abc&#39;)).toEqual(&#39;ABC&#39;);
});

it(&#39;transforms &quot;abc def&quot; to &quot;ABC DEF&quot;&#39;, () =&gt; {
  expect(pipe.transform(&#39;abc def&#39;)).toEqual(&#39;ABC DEF&#39;);
});

it(&#39;leaves &quot;ABC DEF&quot; unchanged&#39;, () =&gt; {
  expect(pipe.transform(&#39;ABC DEF&#39;)).toEqual(&#39;ABC DEF&#39;);
});
</code-example><p>In this chapter we will:</p>
<ul>
<li>create a test before creating a class</li>
<li>load multiple test files in our test harness, using system.js</li>
<li>add the Angular 2 library to our test harness</li>
<li>watch the new test fail, and fix it</li>
</ul>
<div class="callout is-helpful"><header>Prior Knowledge</header><p>The Unit Testing chapters build upon each other. We recommend reading them in order.
We&#39;re also assuming that you&#39;re already comfortable with basic Angular 2 concepts and the tools
we introduced in the <a href="../quickstart.html">QuickStart</a> and
the <a href="../tutorial/">Tour of Heroes</a> tutorial
such as <code>npm</code>, <code>gulp</code>, and <code>live-server</code>.</p>
</div><h2 id="add-another-spec-file">Add another spec file</h2>
<p><strong>Create</strong> a <code>my-uppercase.pipe.spec.ts</code> in <code>app/</code>.</p>
<p><strong>Stop and restart the TypeScript compiler</strong> to ensure we compile the new file.</p>
<p><strong>Add</strong> the following lines of rather obvious Jasmine test code.</p>
<div class="example-title">app/my-uppercase.pipe.spec.ts</div><code-example language="ts" format="linenums">import { MyUppercasePipe } from &#39;./my-uppercase.pipe&#39;;

describe(&#39;MyUppercasePipe&#39;, () =&gt; {
  let pipe: MyUppercasePipe;

  beforeEach(() =&gt; {
    pipe = new MyUppercasePipe();
  });

  it(&#39;transforms &quot;abc&quot; to &quot;ABC&quot;&#39;, () =&gt; {
    expect(pipe.transform(&#39;abc&#39;)).toEqual(&#39;ABC&#39;);
  });

  it(&#39;transforms &quot;abc def&quot; to &quot;ABC DEF&quot;&#39;, () =&gt; {
    expect(pipe.transform(&#39;abc def&#39;)).toEqual(&#39;ABC DEF&#39;);
  });

  it(&#39;leaves &quot;ABC DEF&quot; unchanged&#39;, () =&gt; {
    expect(pipe.transform(&#39;ABC DEF&#39;)).toEqual(&#39;ABC DEF&#39;);
  });
});
</code-example><p>Note that each test is short (one line in our case).
It has a clear label that accurately describes the test. And it makes exactly one expectation.</p>
<p>Anyone can read these tests and understand quickly what the test does and what the pipe does.
If one of the tests fails, we know which expected behavior is no longer true.
We’ll have little trouble maintaining these tests and adding more like them as we encounter new conditions to explore.</p>
<p>That’s the way we like our tests!</p>
<h2 id="add-this-spec-to-unit-tests-html-">Add this spec to <code>unit-tests.html</code></h2>
<p>Now let’s wire our new spec file into the HTML test harness.</p>
<p>Open <code>unit-tests.html</code>. Find <code>System.import(&#39;app/hero.spec&#39;)</code>.</p>
<p>Hmm. We can’t just add <code>System.import(&#39;app/my-uppercase.pipe.spec&#39;)</code>.</p>
<p>The first <code>System.import</code> returns a promise as does this second import.
We can’t run any of the Jasmine tests until <strong>both imports are finished</strong>.</p>
<p>Fortunately, we can create a new <code>Promise</code> that wraps both import promises and waits
for both to finish loading.</p>
<code-example language="html" format="">&lt;script&gt;
  // #2. Import the spec files explicitly
  Promise.all([
    System.import(&#39;app/hero.spec&#39;),
    System.import(&#39;app/my-uppercase.pipe.spec&#39;)
  ])

    // #3. wait for all imports to load ...
    //     then re-execute `window.onload` which
    //     triggers the Jasmine test-runner start
    //     or explain what went wrong.
    .then(window.onload)
    .catch(console.error.bind(console));
&lt;/script&gt;
</code-example><p>We have a pattern for adding new tests.</p>
<p>In future, when we add a new spec, we add another <code>System.import(&#39;app/some.spec&#39;)</code> to
the array argument passed to <code>Promise.all</code>.</p>
<p>Try it. The browser should refresh and show the following in the console:</p>
<code-example format="" language="html" escape="html">GET http://localhost:8080/app/my-uppercase.pipe.js 404 (Not Found)
</code-example><p>Our test failed, as expected. We&#39;re importing something that doesn&#39;t exist and our test fails saying that. All is going according to plan.</p>
<h2 id="the-pipe-if-you-please">The pipe, if you please</h2>
<p>The test is asking for a pipe, and we shall deliver. </p>
<p><strong>Create</strong> a <code>my-uppercase.pipe.ts</code> in <code>app/</code>.</p>
<p><strong>Stop and restart the TypeScript compiler</strong> to ensure we compile the new file.</p>
<p><strong>Add</strong> a basic pipe that doesn&#39;t do anything. We know how to make strings uppercase, but we since we&#39;re letting the test take the lead let&#39;s wait for it to tell us what&#39;s next. Maybe it&#39;ll surprise us.</p>
<div class="example-title">app/my-uppercase.pipe.ts</div><code-example language="ts" format="linenums">import {Pipe, PipeTransform} from &#39;@angular/core&#39;;

@Pipe({ name: &#39;my-uppercase&#39; })
export class MyUppercasePipe implements PipeTransform {
  transform(value: string) {
    return value;
  }
}
</code-example><p>Reload our test page and...</p>
<code-example format="" language="html" escape="html">GET http://localhost:8080/angular2/core 404 (Not Found)
</code-example><h2 id="the-angular-library-if-you-please">The Angular library, if you please</h2>
<p>Looking back at <code>unit-tests.html</code> we realize that we have not loaded the Angular library.
Yet we were able to load and test the application’s <code>Hero</code> interface.</p>
<p><strong>We were lucky!</strong>  The <code>Hero</code> interface has no dependence on Angular.
If it had depended on Angular, we’d still be staring at the Jasmine “big-time fail” screen:</p>
<figure class="image-display"><img src="/resources/images/devguide/testing-an-angular-pipe/big-time-fail-screen.png" alt="Jasmine's' big time fail screen"></figure><p>We are writing an Angular application after all and
we were going to need Angular sooner or later. That time has come.</p>
<p><code>MyUppercasePipe</code> depends on Angular as is clear in the first few lines:</p>
<code-example language="ts" format="">import {Pipe, PipeTransform} from &#39;@angular/core&#39;;
</code-example><p><strong>Open</strong> <code>unit-tests.html</code></p>
<p><strong>Find</strong> the <code>&lt;!-- #1. add the system.js library --&gt;</code> comment.</p>
<p><strong>Replace</strong> the scripts tags beneath it with the all the needed angular scripts:</p>
<code-example language="html" format="">&lt;!-- #1. add the system.js and angular libraries --&gt;
  &lt;script src=&quot;node_modules/zone.js/dist/zone.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;node_modules/reflect-metadata/Reflect.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;node_modules/systemjs/dist/system.src.js&quot;&gt;&lt;/script&gt;

  &lt;script src=&quot;systemjs.config.js&quot;&gt;&lt;/script&gt;
</code-example><p>We should now be ready to see our 3 expectations fail when reloading our test page.</p>
<figure class="image-display"><img src="/resources/images/devguide/testing-an-angular-pipe/two-failures.png" alt="2 failed tests"></figure><h2 id="uppercase-if-you-please">Uppercase, if you please</h2>
<p>The first two tests that passed were our old <code>hero</code> interface tests, so it makes sense that those passed. Of our three new expectations, one still passed though.</p>
<pre><code>  MyUppercasePipe
    transforms &quot;abc&quot; to &quot;ABC&quot;
    transforms &quot;abc def&quot; to &quot;ABC DEF&quot;
    leaves &quot;ABC DEF&quot; unchanged
</code></pre><p>Ah but of course! Our simple pipe doesn&#39;t transform the input at all, and the third test expected
input to not be changed.</p>
<p>All we have to do now is actually transform text to uppercase in our pipe.</p>
<code-example language="ts" format="">transform(value: string) {
  return value.toUpperCase();
}
</code-example><p>Are we done now?</p>
<figure class="image-display"><img src="/resources/images/devguide/testing-an-angular-pipe/zero-failures.png" alt="0 failed tests"></figure><p>The glorious green is back with us again!</p>
<p>We tried a bit of test driven development and it seems to have guided us to success.</p>
<p>But it&#39;s not always feasible. For instance, sometimes we need to write tests for existing functionality, like what we&#39;re about to do with the rest of Tour of Heroes. </p>
<p>If we are writing new code though, writing tests might just be what we need to help us track our progress and keep the end result in sight at all times.</p>
<h2 id="what-s-next-">What’s Next?</h2>
<p>Now we can test parts of our application that we <em>load</em> asynchronously with system.js.</p>
<p>What about testing parts that <em>are themselves asynchronous</em>?</p>
<p>Let&#39;s test a service with a public asynchronous method that fetches heroes from a remote server.</p>
<a href="#top" class="to-top">Back to top</a><div class="alert is-important"><p>The testing chapter is still under development.
Please bear with us as we both update and complete it.</p>
</div><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--></div></div></div></article><div class="main-footer"><nav class="background-blue-grey-900 grid-fluid"><div class="c3 main-footer-branding"><div class="logo-inverse-large"></div></div><div class="c3"><h3 class="text-headline">RESOURCES</h3><ul class="text-body"><!-- TODO: (ericjim) make a libraries page to showcase all angular 2 libraries--><!--li <a href="/libraries.html">Libraries</a>--><li><a href="/about/">About</a></li><li><a href="/resources/">Books & Training</a></li><li><a href="/resources/">Tools & Libraries</a></li><li><a href="/resources/">Community</a></li><li><a href="/presskit.html">Press Kit</a></li></ul></div><div class="c3"><h3 class="text-headline">HELP</h3><ul class="text-body"><li><a href="http://stackoverflow.com/questions/tagged/angular2">Stack Overflow</a></li><li><a href="https://gitter.im/angular/angular">Gitter</a></li><li><a href="https://groups.google.com/forum/#!forum/angular"> Google Group</a></li><li><a href="https://github.com/angular/angular/issues"> Report Issues</a></li><li><a class="footer-feedback" ng-click="appCtrl.openFeedback()" aria-label="Submit feedback on this page"> Site Feedback</a></li></ul></div><div class="c3"><h3 class="text-headline">COMMUNITY</h3><ul class="text-body"><li><a href="/events.html">Events</a></li><li><a href="http://www.meetup.com/topics/angularjs/">Meetups</a></li><li><a href="https://twitter.com/angularjs"> Twitter</a></li><li><a href="https://github.com/angular/angular"> GitHub</a></li><li><a href="/contribute.html"> Contribute</a></li></ul></div></nav><footer class="background-steel"><small class="text-caption">Powered by Google ©2010-2016. Code licensed under an <a href="/license" class="text-snow">MIT-style License</a>. Documentation licensed under <a class="text-snow" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.</small><a aria-label="View Style Guide" href="/docs/ts/latest/styleguide.html" title="Style Guide" md-button="md-button" class="styleguide-trigger text-snow"><span class="icon-favorite"></span></a></footer></div><!-- VENDORS --><script src="/resources/js/vendor/prettify.js"></script><script src="/resources/js/vendor/lang-basic.js"></script><script src="/resources/js/vendor/lang-dart.js"></script><script src="/resources/js/vendor/lodash.js"></script><script src="/resources/js/vendor/clipboard.min.js"></script><!-- Angular Material Dependencies --><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-animate.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-aria.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.js"></script><!-- Firebase -->
<script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
<!-- AngularFire -->
<script src="https://cdn.firebase.com/libs/angularfire/1.2.0/angularfire.min.js"></script>
<!-- Angular.io Site JS --><script src="/resources/js/site.js"></script><script src="/resources/js/controllers/app-controller.js"></script><script src="/resources/js/controllers/resources-controller.js"></script><script src="/resources/js/directives/cheatsheet.js"></script><script src="/resources/js/directives/api-list.js"></script><script src="/resources/js/directives/bio.js"></script><script src="/resources/js/directives/bold.js"></script><script src="/resources/js/directives/code.js"></script><script src="/resources/js/directives/copy.js"></script><script src="/resources/js/directives/code-tabs.js"></script><script src="/resources/js/directives/code-pane.js"></script><script src="/resources/js/directives/code-example.js"></script><script src="/resources/js/directives/scroll-y-offset-element.js"></script><!-- GA --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-8594346-15', 'auto');
ga('send', 'pageview')

</script><!-- SWIFTYPE --><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

_st('install','VsuU7kH5Hnnj9tfyNvfK');
</script><!-- Google Feedback --><script src="//www.gstatic.com/feedback/api.js" type="text/javascript"></script><!-- Twitter Widget --><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}})(document,"script","twitter-wjs");</script></body></html>